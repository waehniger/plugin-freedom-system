# Parameter Specification: MuSam

**CRITICAL CONTRACT:** This specification is immutable during implementation (Stages 1-3).

**Generated by:** UI mockup finalization (ui-mockup skill, v1)
**Generated date:** 2025-11-16
**Source:** v1-ui.yaml

## Total Parameter Count

**Total:** 53 parameters
- Global: 2 parameters
- Region (5 regions × 8 parameters): 40 parameters
- Sequencer: 11 parameters

## Parameter Definitions

### Global Parameters

#### speed
- **Type:** Float
- **Range:** 0.5 to 2.0
- **Default:** 1.0
- **Unit:** x (multiplier)
- **Skew Factor:** linear
- **UI Control:** Vertical slider, right sidebar (top)
- **DSP Usage:** Playback rate (tape-style speed control)

#### volume
- **Type:** Float
- **Range:** -60.0 to 0.0 dB
- **Default:** -6.0
- **Unit:** dB
- **Skew Factor:** linear
- **UI Control:** Vertical slider, right sidebar (bottom)
- **DSP Usage:** Master output gain

### Region 1 Parameters

#### region_1_start
- **Type:** Float
- **Range:** 0.0 to 100.0%
- **Default:** 0.0
- **Unit:** %
- **Skew Factor:** linear
- **UI Control:** Waveform marker (draggable)
- **DSP Usage:** Region start position in sample

#### region_1_end
- **Type:** Float
- **Range:** 0.0 to 100.0%
- **Default:** 20.0
- **Unit:** %
- **Skew Factor:** linear
- **UI Control:** Waveform marker (draggable)
- **DSP Usage:** Region end position in sample

#### region_1_pitch
- **Type:** Float
- **Range:** -24.0 to 24.0 semitones
- **Default:** 0.0
- **Unit:** st (semitones)
- **Skew Factor:** linear
- **UI Control:** Vertical slider
- **DSP Usage:** Pitch shift for region

#### region_1_filter_cutoff
- **Type:** Float
- **Range:** 20.0 to 20000.0 Hz
- **Default:** 20000.0
- **Unit:** Hz
- **Skew Factor:** 0.3 (logarithmic)
- **UI Control:** Rotary knob
- **DSP Usage:** Lowpass filter cutoff frequency

#### region_1_filter_resonance
- **Type:** Float
- **Range:** 0.0 to 100.0%
- **Default:** 0.0
- **Unit:** %
- **Skew Factor:** linear
- **UI Control:** Rotary knob
- **DSP Usage:** Lowpass filter resonance/Q

#### region_1_attack
- **Type:** Float
- **Range:** 0.0 to 1000.0 ms
- **Default:** 10.0
- **Unit:** ms
- **Skew Factor:** linear
- **UI Control:** Vertical slider
- **DSP Usage:** Envelope attack time

#### region_1_decay
- **Type:** Float
- **Range:** 0.0 to 5000.0 ms
- **Default:** 500.0
- **Unit:** ms
- **Skew Factor:** linear
- **UI Control:** Vertical slider
- **DSP Usage:** Envelope decay time

#### region_1_pan
- **Type:** Float
- **Range:** -100.0 to 100.0%
- **Default:** 0.0
- **Unit:** % (L/R)
- **Skew Factor:** linear
- **UI Control:** Rotary knob
- **DSP Usage:** Stereo pan position

### Region 2 Parameters

#### region_2_start
- **Type:** Float
- **Range:** 0.0 to 100.0%
- **Default:** 20.0
- **Unit:** %
- **Skew Factor:** linear
- **UI Control:** Waveform marker (draggable)
- **DSP Usage:** Region start position in sample

#### region_2_end
- **Type:** Float
- **Range:** 0.0 to 100.0%
- **Default:** 40.0
- **Unit:** %
- **Skew Factor:** linear
- **UI Control:** Waveform marker (draggable)
- **DSP Usage:** Region end position in sample

#### region_2_pitch
- **Type:** Float
- **Range:** -24.0 to 24.0 semitones
- **Default:** 0.0
- **Unit:** st
- **Skew Factor:** linear
- **UI Control:** Vertical slider
- **DSP Usage:** Pitch shift for region

#### region_2_filter_cutoff
- **Type:** Float
- **Range:** 20.0 to 20000.0 Hz
- **Default:** 20000.0
- **Unit:** Hz
- **Skew Factor:** 0.3 (logarithmic)
- **UI Control:** Rotary knob
- **DSP Usage:** Lowpass filter cutoff frequency

#### region_2_filter_resonance
- **Type:** Float
- **Range:** 0.0 to 100.0%
- **Default:** 0.0
- **Unit:** %
- **Skew Factor:** linear
- **UI Control:** Rotary knob
- **DSP Usage:** Lowpass filter resonance/Q

#### region_2_attack
- **Type:** Float
- **Range:** 0.0 to 1000.0 ms
- **Default:** 10.0
- **Unit:** ms
- **Skew Factor:** linear
- **UI Control:** Vertical slider
- **DSP Usage:** Envelope attack time

#### region_2_decay
- **Type:** Float
- **Range:** 0.0 to 5000.0 ms
- **Default:** 500.0
- **Unit:** ms
- **Skew Factor:** linear
- **UI Control:** Vertical slider
- **DSP Usage:** Envelope decay time

#### region_2_pan
- **Type:** Float
- **Range:** -100.0 to 100.0%
- **Default:** 0.0
- **Unit:** %
- **Skew Factor:** linear
- **UI Control:** Rotary knob
- **DSP Usage:** Stereo pan position

### Region 3 Parameters

#### region_3_start
- **Type:** Float
- **Range:** 0.0 to 100.0%
- **Default:** 40.0
- **Unit:** %
- **Skew Factor:** linear
- **UI Control:** Waveform marker (draggable)
- **DSP Usage:** Region start position in sample

#### region_3_end
- **Type:** Float
- **Range:** 0.0 to 100.0%
- **Default:** 60.0
- **Unit:** %
- **Skew Factor:** linear
- **UI Control:** Waveform marker (draggable)
- **DSP Usage:** Region end position in sample

#### region_3_pitch
- **Type:** Float
- **Range:** -24.0 to 24.0 semitones
- **Default:** 0.0
- **Unit:** st
- **Skew Factor:** linear
- **UI Control:** Vertical slider
- **DSP Usage:** Pitch shift for region

#### region_3_filter_cutoff
- **Type:** Float
- **Range:** 20.0 to 20000.0 Hz
- **Default:** 20000.0
- **Unit:** Hz
- **Skew Factor:** 0.3 (logarithmic)
- **UI Control:** Rotary knob
- **DSP Usage:** Lowpass filter cutoff frequency

#### region_3_filter_resonance
- **Type:** Float
- **Range:** 0.0 to 100.0%
- **Default:** 0.0
- **Unit:** %
- **Skew Factor:** linear
- **UI Control:** Rotary knob
- **DSP Usage:** Lowpass filter resonance/Q

#### region_3_attack
- **Type:** Float
- **Range:** 0.0 to 1000.0 ms
- **Default:** 10.0
- **Unit:** ms
- **Skew Factor:** linear
- **UI Control:** Vertical slider
- **DSP Usage:** Envelope attack time

#### region_3_decay
- **Type:** Float
- **Range:** 0.0 to 5000.0 ms
- **Default:** 500.0
- **Unit:** ms
- **Skew Factor:** linear
- **UI Control:** Vertical slider
- **DSP Usage:** Envelope decay time

#### region_3_pan
- **Type:** Float
- **Range:** -100.0 to 100.0%
- **Default:** 0.0
- **Unit:** %
- **Skew Factor:** linear
- **UI Control:** Rotary knob
- **DSP Usage:** Stereo pan position

### Region 4 Parameters

#### region_4_start
- **Type:** Float
- **Range:** 0.0 to 100.0%
- **Default:** 60.0
- **Unit:** %
- **Skew Factor:** linear
- **UI Control:** Waveform marker (draggable)
- **DSP Usage:** Region start position in sample

#### region_4_end
- **Type:** Float
- **Range:** 0.0 to 100.0%
- **Default:** 80.0
- **Unit:** %
- **Skew Factor:** linear
- **UI Control:** Waveform marker (draggable)
- **DSP Usage:** Region end position in sample

#### region_4_pitch
- **Type:** Float
- **Range:** -24.0 to 24.0 semitones
- **Default:** 0.0
- **Unit:** st
- **Skew Factor:** linear
- **UI Control:** Vertical slider
- **DSP Usage:** Pitch shift for region

#### region_4_filter_cutoff
- **Type:** Float
- **Range:** 20.0 to 20000.0 Hz
- **Default:** 20000.0
- **Unit:** Hz
- **Skew Factor:** 0.3 (logarithmic)
- **UI Control:** Rotary knob
- **DSP Usage:** Lowpass filter cutoff frequency

#### region_4_filter_resonance
- **Type:** Float
- **Range:** 0.0 to 100.0%
- **Default:** 0.0
- **Unit:** %
- **Skew Factor:** linear
- **UI Control:** Rotary knob
- **DSP Usage:** Lowpass filter resonance/Q

#### region_4_attack
- **Type:** Float
- **Range:** 0.0 to 1000.0 ms
- **Default:** 10.0
- **Unit:** ms
- **Skew Factor:** linear
- **UI Control:** Vertical slider
- **DSP Usage:** Envelope attack time

#### region_4_decay
- **Type:** Float
- **Range:** 0.0 to 5000.0 ms
- **Default:** 500.0
- **Unit:** ms
- **Skew Factor:** linear
- **UI Control:** Vertical slider
- **DSP Usage:** Envelope decay time

#### region_4_pan
- **Type:** Float
- **Range:** -100.0 to 100.0%
- **Default:** 0.0
- **Unit:** %
- **Skew Factor:** linear
- **UI Control:** Rotary knob
- **DSP Usage:** Stereo pan position

### Region 5 Parameters

#### region_5_start
- **Type:** Float
- **Range:** 0.0 to 100.0%
- **Default:** 80.0
- **Unit:** %
- **Skew Factor:** linear
- **UI Control:** Waveform marker (draggable)
- **DSP Usage:** Region start position in sample

#### region_5_end
- **Type:** Float
- **Range:** 0.0 to 100.0%
- **Default:** 100.0
- **Unit:** %
- **Skew Factor:** linear
- **UI Control:** Waveform marker (draggable)
- **DSP Usage:** Region end position in sample

#### region_5_pitch
- **Type:** Float
- **Range:** -24.0 to 24.0 semitones
- **Default:** 0.0
- **Unit:** st
- **Skew Factor:** linear
- **UI Control:** Vertical slider
- **DSP Usage:** Pitch shift for region

#### region_5_filter_cutoff
- **Type:** Float
- **Range:** 20.0 to 20000.0 Hz
- **Default:** 20000.0
- **Unit:** Hz
- **Skew Factor:** 0.3 (logarithmic)
- **UI Control:** Rotary knob
- **DSP Usage:** Lowpass filter cutoff frequency

#### region_5_filter_resonance
- **Type:** Float
- **Range:** 0.0 to 100.0%
- **Default:** 0.0
- **Unit:** %
- **Skew Factor:** linear
- **UI Control:** Rotary knob
- **DSP Usage:** Lowpass filter resonance/Q

#### region_5_attack
- **Type:** Float
- **Range:** 0.0 to 1000.0 ms
- **Default:** 10.0
- **Unit:** ms
- **Skew Factor:** linear
- **UI Control:** Vertical slider
- **DSP Usage:** Envelope attack time

#### region_5_decay
- **Type:** Float
- **Range:** 0.0 to 5000.0 ms
- **Default:** 500.0
- **Unit:** ms
- **Skew Factor:** linear
- **UI Control:** Vertical slider
- **DSP Usage:** Envelope decay time

#### region_5_pan
- **Type:** Float
- **Range:** -100.0 to 100.0%
- **Default:** 0.0
- **Unit:** %
- **Skew Factor:** linear
- **UI Control:** Rotary knob
- **DSP Usage:** Stereo pan position

### Sequencer Parameters

#### step_1_region
- **Type:** Choice
- **Choices:** ["None", "Region 1", "Region 2", "Region 3", "Region 4", "Region 5"]
- **Default:** 1 (Region 1)
- **UI Control:** Dropdown / sequencer step
- **DSP Usage:** Region assignment for step 1

#### step_2_region
- **Type:** Choice
- **Choices:** ["None", "Region 1", "Region 2", "Region 3", "Region 4", "Region 5"]
- **Default:** 2 (Region 2)
- **UI Control:** Dropdown / sequencer step
- **DSP Usage:** Region assignment for step 2

#### step_3_region
- **Type:** Choice
- **Choices:** ["None", "Region 1", "Region 2", "Region 3", "Region 4", "Region 5"]
- **Default:** 3 (Region 3)
- **UI Control:** Dropdown / sequencer step
- **DSP Usage:** Region assignment for step 3

#### step_4_region
- **Type:** Choice
- **Choices:** ["None", "Region 1", "Region 2", "Region 3", "Region 4", "Region 5"]
- **Default:** 4 (Region 4)
- **UI Control:** Dropdown / sequencer step
- **DSP Usage:** Region assignment for step 4

#### step_5_region
- **Type:** Choice
- **Choices:** ["None", "Region 1", "Region 2", "Region 3", "Region 4", "Region 5"]
- **Default:** 5 (Region 5)
- **UI Control:** Dropdown / sequencer step
- **DSP Usage:** Region assignment for step 5

#### step_6_region
- **Type:** Choice
- **Choices:** ["None", "Region 1", "Region 2", "Region 3", "Region 4", "Region 5"]
- **Default:** 0 (None)
- **UI Control:** Dropdown / sequencer step
- **DSP Usage:** Region assignment for step 6

#### step_7_region
- **Type:** Choice
- **Choices:** ["None", "Region 1", "Region 2", "Region 3", "Region 4", "Region 5"]
- **Default:** 0 (None)
- **UI Control:** Dropdown / sequencer step
- **DSP Usage:** Region assignment for step 7

#### step_8_region
- **Type:** Choice
- **Choices:** ["None", "Region 1", "Region 2", "Region 3", "Region 4", "Region 5"]
- **Default:** 0 (None)
- **UI Control:** Dropdown / sequencer step
- **DSP Usage:** Region assignment for step 8

#### playback_mode
- **Type:** Choice
- **Choices:** ["Sequential", "Random", "Custom"]
- **Default:** 0 (Sequential)
- **UI Control:** Dropdown
- **DSP Usage:** Sequencer playback mode

#### loop_mode
- **Type:** Bool
- **Range:** On/Off
- **Default:** true (On)
- **UI Control:** Toggle switch
- **DSP Usage:** Sequence loop enable/disable

#### crossfade_time
- **Type:** Float
- **Range:** 0.0 to 500.0 ms
- **Default:** 50.0
- **Unit:** ms
- **Skew Factor:** linear
- **UI Control:** Horizontal slider
- **DSP Usage:** Region transition crossfade duration

## Implementation Notes

### Parameter Grouping

Parameters are organized in three logical groups:

1. **Global** (2): Controls affecting overall plugin behavior
2. **Regions** (40): 5 regions × 8 parameters each (start, end, pitch, cutoff, resonance, attack, decay, pan)
3. **Sequencer** (11): 8 step assignments + 3 global sequencer controls

### UI Interaction Model

- **Smart UI:** Only the selected region's 6 controls are visible in the control strip at a time
- **Region selection:** Click region marker in waveform to switch active region
- **Visual feedback:** Active region highlighted with color-coded fill and marker

### APVTS Implementation Order

Parameters must be implemented in EXACT order during Stage 1 (Shell):

1. Global parameters (speed, volume)
2. Region 1 parameters (all 8)
3. Region 2 parameters (all 8)
4. Region 3 parameters (all 8)
5. Region 4 parameters (all 8)
6. Region 5 parameters (all 8)
7. Sequencer parameters (all 11)

### Relay Type Mapping

- **Float parameters** → `juce::WebSliderRelay`
- **Bool parameters** → `juce::WebToggleButtonRelay`
- **Choice parameters** → `juce::WebComboBoxRelay`

### Attachment Count Verification

- Total relays: 53
- Total attachments: 53
- Relay count MUST equal attachment count

## Contract Status

This parameter specification is **LOCKED** for implementation. Any changes require:
1. Return to Stage 0 (Planning)
2. Update creative brief and mockup
3. Regenerate parameter-spec.md
4. Restart implementation from Stage 1
